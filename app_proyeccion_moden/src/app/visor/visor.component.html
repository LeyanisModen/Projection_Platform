<div class="visor-container" [class.blackout]="mesaState?.blackout">

    <!-- LOADING STATE -->
    @if (mode === 'LOADING') {
    <div class="loading-screen">
        <div class="spinner"></div>
        <p>Conectando...</p>
    </div>
    }

    <!-- PAIRING MODE -->
    @if (mode === 'PAIRING') {
    <div class="pairing-screen">
        <p class="pairing-label">CÓDIGO DE VINCULACIÓN</p>
        <p class="pairing-code">{{ pairingCode }}</p>
        <p class="pairing-hint">Introduce este código en el Dashboard para vincular esta mesa.</p>
    </div>
    }

    <!-- ERROR STATE -->
    @if (mode === 'ERROR') {
    <div class="error-screen">
        <p class="error-title">Error</p>
        <p class="error-message">{{ errorMessage }}</p>
        <button (click)="requestPairingCode()">Reintentar</button>
    </div>
    }

    <!-- PROJECTION MODE -->
    @if (mode === 'PROJECTION') {
    <div class="projection-screen">
        <app-mapper [imageUrl]="mesaState?.image_url ?? null"
            [isCalibrationActive]="(!mesaState?.image_url || mesaState?.mapper_enabled) ?? false">
        </app-mapper>
    </div>
    }

</div>